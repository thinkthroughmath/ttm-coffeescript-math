<!DOCTYPE html>

<html>
<head>
  <title>expression_components_spec.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width, target-densitydpi=160dpi, initial-scale=1.0; maximum-scale=1.0; user-scalable=0;">
  <link rel="stylesheet" media="all" href="docco.css" />
</head>
<body>
  <div id="container">
    <div id="background"></div>
    
      <ul id="jump_to">
        <li>
          <a class="large" href="javascript:void(0);">Jump To &hellip;</a>
          <a class="small" href="javascript:void(0);">+</a>
          <div id="jump_wrapper">
          <div id="jump_page">
            
              
              <a class="source" href="build_expression_from_javascript_object_spec.html">
                build_expression_from_javascript_object_spec.coffee
              </a>
            
              
              <a class="source" href="expression_components_spec.html">
                expression_components_spec.coffee
              </a>
            
              
              <a class="source" href="expression_equality_spec.html">
                expression_equality_spec.coffee
              </a>
            
              
              <a class="source" href="expression_evaluation_spec.html">
                expression_evaluation_spec.coffee
              </a>
            
              
              <a class="source" href="expression_manipulation_spec.html">
                expression_manipulation_spec.coffee
              </a>
            
              
              <a class="source" href="expression_position_spec.html">
                expression_position_spec.coffee
              </a>
            
              
              <a class="source" href="expression_to_string_spec.html">
                expression_to_string_spec.coffee
              </a>
            
              
              <a class="source" href="expression_traversal_spec.html">
                expression_traversal_spec.coffee
              </a>
            
              
              <a class="source" href="feature_spec.html">
                feature_spec.coffee
              </a>
            
              
              <a class="source" href="precise_spec.html">
                precise_spec.coffee
              </a>
            
              
              <a class="source" href="spec_helpers.html">
                spec_helpers.coffee
              </a>
            
              
              <a class="source" href="browser.html">
                browser.coffee
              </a>
            
              
              <a class="source" href="math.html">
                math.coffee
              </a>
            
              
              <a class="source" href="build_expression_from_javascript_object.html">
                build_expression_from_javascript_object.coffee
              </a>
            
              
              <a class="source" href="expression_components.html">
                expression_components.coffee
              </a>
            
              
              <a class="source" href="expression_equality.html">
                expression_equality.coffee
              </a>
            
              
              <a class="source" href="expression_evaluation.html">
                expression_evaluation.coffee
              </a>
            
              
              <a class="source" href="expression_manipulation.html">
                expression_manipulation.coffee
              </a>
            
              
              <a class="source" href="expression_position.html">
                expression_position.coffee
              </a>
            
              
              <a class="source" href="expression_to_string.html">
                expression_to_string.coffee
              </a>
            
              
              <a class="source" href="expression_traversal.html">
                expression_traversal.coffee
              </a>
            
              
              <a class="source" href="precise.html">
                precise.coffee
              </a>
            
          </div>
        </li>
      </ul>
    
    <ul class="sections">
        
          <li id="title">
              <div class="annotation">
                  <h1>expression_components_spec.coffee</h1>
              </div>
          </li>
        
        
        
        <li id="section-1">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-1">&#182;</a>
              </div>
              
            </div>
            
            <div class="content"><div class='highlight'><pre>ttm = thinkthroughmath

<span class="hljs-function"><span class="hljs-title">it_adheres_to_the_expression_component_interface</span> = <span class="hljs-params">(opts)</span>-&gt;</span>
  describe <span class="hljs-string">"expression component interface"</span>,<span class="hljs-function"> -&gt;</span>
    beforeEach<span class="hljs-function"> -&gt;</span>
      <span class="hljs-property">@comp</span> = opts.instance_fn.call(@)
    it <span class="hljs-string">"responds to ID"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@comp</span>.id()).toEqual opts.id

    describe <span class="hljs-string">"after cloning it"</span>,<span class="hljs-function"> -&gt;</span>
      it <span class="hljs-string">"maintains its id"</span>,<span class="hljs-function"> -&gt;</span>
        new_comp = <span class="hljs-property">@comp</span>.clone()
        expect(new_comp.id()).toEqual opts.id

    it <span class="hljs-string">"has type-introspection methods"</span>,<span class="hljs-function"> -&gt;</span></pre></div></div>
            
        </li>
        
        
        <li id="section-2">
            <div class="annotation">
              
              <div class="pilwrap ">
                <a class="pilcrow" href="#section-2">&#182;</a>
              </div>
              <p>just want to verify that these are methods
would fail if they werenâ€™t</p>

            </div>
            
            <div class="content"><div class='highlight'><pre>      <span class="hljs-property">@comp</span>.isExpression()
      <span class="hljs-property">@comp</span>.isFraction()
      <span class="hljs-property">@comp</span>.isNumber()
      <span class="hljs-property">@comp</span>.isVariable()
      <span class="hljs-property">@comp</span>.isFraction()
      <span class="hljs-property">@comp</span>.isExponentiation()
      <span class="hljs-property">@comp</span>.isRoot()

describe <span class="hljs-string">"Expression Components"</span>,<span class="hljs-function"> -&gt;</span>
  beforeEach<span class="hljs-function"> -&gt;</span>
    <span class="hljs-property">@comps</span> = ttm.lib.math.ExpressionComponentSource.build()

    <span class="hljs-property">@expression_to_string</span> = <span class="hljs-function"><span class="hljs-params">(exp)</span>-&gt;</span>
      ttm.lib.math.ExpressionToString.toString(exp)

    <span class="hljs-property">@expect_value</span> = <span class="hljs-function"><span class="hljs-params">(expression, value)</span>-&gt;</span>
      expect(<span class="hljs-property">@expression_to_string</span>(expression)).toEqual value
    <span class="hljs-property">@math</span> = ttm.lib.math.math_lib.build()
    <span class="hljs-property">@h</span> = <span class="hljs-keyword">new</span> Helper(<span class="hljs-property">@comps</span>)

  describe <span class="hljs-string">"expressions"</span>,<span class="hljs-function"> -&gt;</span>
    it_adheres_to_the_expression_component_interface {
      <span class="hljs-attribute">instance_fn</span>:<span class="hljs-function"> -&gt;</span>
        <span class="hljs-property">@comps</span>.build_expression(<span class="hljs-attribute">id</span>: <span class="hljs-number">9876</span>)
      <span class="hljs-attribute">id</span>: <span class="hljs-number">9876</span>
    }

    it <span class="hljs-string">"assigns components from its construtor"</span>,<span class="hljs-function"> -&gt;</span>
      exp = <span class="hljs-property">@comps</span>.build_expression(
        <span class="hljs-attribute">expression</span>: [
          <span class="hljs-property">@comps</span>.build_number(<span class="hljs-attribute">value</span>: <span class="hljs-string">'10'</span>)
        ])
      exp_pos = <span class="hljs-property">@math</span>.expression_position.buildExpressionPositionAsLast(exp)
      <span class="hljs-property">@expect_value</span>(exp_pos, <span class="hljs-string">'10'</span>)

    it <span class="hljs-string">"is isExpression"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@comps</span>.build_expression().isExpression()).toEqual <span class="hljs-literal">true</span>

  describe <span class="hljs-string">"numbers"</span>,<span class="hljs-function"> -&gt;</span>
    beforeEach<span class="hljs-function"> -&gt;</span>
      <span class="hljs-property">@n</span> = <span class="hljs-function"><span class="hljs-params">(arg)</span>=&gt;</span> <span class="hljs-property">@math</span>.components.build_number(arg)
    it <span class="hljs-string">"returns a number with a negative version"</span>,<span class="hljs-function"> -&gt;</span>
      num = <span class="hljs-property">@comps</span>.classes.number.build(<span class="hljs-attribute">value</span>: <span class="hljs-number">10</span>)
      neg_num = num.negated()
      expect(neg_num.value()).toEqual <span class="hljs-string">"-10"</span>

    it <span class="hljs-string">"supports concatenation"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@n</span>(<span class="hljs-attribute">value</span>: <span class="hljs-number">1</span>).concatenate(<span class="hljs-number">0</span>).concatenate(<span class="hljs-number">1</span>).value()).toEqual <span class="hljs-string">'101'</span>

    it <span class="hljs-string">"supports concatenation with a decimal"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@n</span>(<span class="hljs-attribute">value</span>: <span class="hljs-number">1</span>).futureAsDecimal().concatenate(<span class="hljs-number">0</span>).concatenate(<span class="hljs-number">1</span>).value()).toEqual <span class="hljs-string">'1.01'</span>

    it <span class="hljs-string">"normalizes fractions in its constructor"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@n</span>(<span class="hljs-attribute">value</span>: <span class="hljs-string">"1/4"</span>).value()).toEqual <span class="hljs-string">'0.25'</span>

  describe <span class="hljs-string">"roots"</span>,<span class="hljs-function"> -&gt;</span>
    it_adheres_to_the_expression_component_interface {
      <span class="hljs-attribute">instance_fn</span>:<span class="hljs-function"> -&gt;</span>
        <span class="hljs-property">@comps</span>.build_root(
          <span class="hljs-attribute">degree</span>: <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">2</span>),
          <span class="hljs-attribute">radicand</span>: <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">100</span>),
          <span class="hljs-attribute">id</span>: <span class="hljs-number">12345</span>)

      <span class="hljs-attribute">id</span>: <span class="hljs-number">12345</span>
    }

    beforeEach<span class="hljs-function"> -&gt;</span>
      <span class="hljs-property">@root</span> = <span class="hljs-property">@comps</span>.build_root(
        <span class="hljs-attribute">degree</span>: <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">2</span>),
        <span class="hljs-attribute">radicand</span>: <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">100</span>)
      )

    it <span class="hljs-string">"has a reference to the degree"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@root</span>.degree()).toBeAnEqualExpressionTo <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">2</span>)

    it <span class="hljs-string">"has a reference to the radicand"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@root</span>.radicand()).toBeAnEqualExpressionTo <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">100</span>)

    it <span class="hljs-string">"can update its radicand"</span>,<span class="hljs-function"> -&gt;</span>
      new_rad = <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">5</span>)
      updated = <span class="hljs-property">@root</span>.updateRadicand(new_rad)

      expect(updated.degree()).toBeAnEqualExpressionTo <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">2</span>)
      expect(updated.radicand()).toBeAnEqualExpressionTo <span class="hljs-property">@h</span>.numberExpression(<span class="hljs-number">5</span>)

    it <span class="hljs-string">"clones correctly"</span>,<span class="hljs-function"> -&gt;</span>
      new_root = <span class="hljs-property">@root</span>.clone()
      new_root.doot = <span class="hljs-number">10</span>

      expect(<span class="hljs-property">@root</span>).toBeAnEqualExpressionTo(new_root)
      expect(<span class="hljs-property">@root</span>.doot).<span class="hljs-keyword">not</span>.toBeAnEqualExpressionTo new_root.doot

  describe <span class="hljs-string">"division"</span>,<span class="hljs-function"> -&gt;</span>
    it_adheres_to_the_expression_component_interface {
      <span class="hljs-attribute">instance_fn</span>:<span class="hljs-function"> -&gt;</span>
        <span class="hljs-property">@comps</span>.build_division(<span class="hljs-attribute">id</span>: <span class="hljs-number">12345</span>)
      <span class="hljs-attribute">id</span>: <span class="hljs-number">12345</span>
    }

  describe <span class="hljs-string">"variables"</span>,<span class="hljs-function"> -&gt;</span>
    it_adheres_to_the_expression_component_interface {
      <span class="hljs-attribute">instance_fn</span>:<span class="hljs-function"> -&gt;</span>
        <span class="hljs-property">@comps</span>.build_variable(<span class="hljs-attribute">name</span>: <span class="hljs-string">"example"</span>, <span class="hljs-attribute">id</span>: <span class="hljs-number">678</span>)
      <span class="hljs-attribute">id</span>: <span class="hljs-number">678</span>
    }

    it <span class="hljs-string">"will tell you its name"</span>,<span class="hljs-function"> -&gt;</span>
      <span class="hljs-property">@variable</span> = <span class="hljs-property">@comps</span>.build_variable(<span class="hljs-attribute">name</span>: <span class="hljs-string">"doot"</span>)
      expect(<span class="hljs-property">@variable</span>.name()).toEqual(<span class="hljs-string">"doot"</span>)

  describe <span class="hljs-string">"fns"</span>,<span class="hljs-function"> -&gt;</span>
    it_adheres_to_the_expression_component_interface {
      <span class="hljs-attribute">instance_fn</span>:<span class="hljs-function"> -&gt;</span>
        <span class="hljs-property">@comps</span>.build_fn(<span class="hljs-attribute">name</span>: <span class="hljs-string">"example"</span>, <span class="hljs-attribute">id</span>: <span class="hljs-number">678</span>)
      <span class="hljs-attribute">id</span>: <span class="hljs-number">678</span>
    }

  describe <span class="hljs-string">"fraction"</span>,<span class="hljs-function"> -&gt;</span>
    it_adheres_to_the_expression_component_interface {
      <span class="hljs-attribute">instance_fn</span>:<span class="hljs-function"> -&gt;</span>
        <span class="hljs-property">@comps</span>.build_fraction(<span class="hljs-attribute">id</span>: <span class="hljs-number">678</span>)
      <span class="hljs-attribute">id</span>: <span class="hljs-number">678</span>
    }

    it <span class="hljs-string">"is isFraction"</span>,<span class="hljs-function"> -&gt;</span>
      <span class="hljs-property">@frac</span> = <span class="hljs-property">@comps</span>.build_fraction()
      expect(<span class="hljs-property">@frac</span>.isFraction()).toEqual <span class="hljs-literal">true</span>

  describe <span class="hljs-string">"pi"</span>,<span class="hljs-function"> -&gt;</span>
    it_adheres_to_the_expression_component_interface {
      <span class="hljs-attribute">instance_fn</span>:<span class="hljs-function"> -&gt;</span>
        <span class="hljs-property">@comps</span>.build_pi(<span class="hljs-attribute">id</span>: <span class="hljs-number">678</span>)
      <span class="hljs-attribute">id</span>: <span class="hljs-number">678</span>
    }

    it <span class="hljs-string">"defaults to the js value"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@comps</span>.build_pi().value()).toMatch <span class="hljs-regexp">/3.14159/</span>

    it <span class="hljs-string">"allows overridden values"</span>,<span class="hljs-function"> -&gt;</span>
      expect(<span class="hljs-property">@comps</span>.build_pi(<span class="hljs-attribute">value</span>: <span class="hljs-number">3</span>).value()).toEqual <span class="hljs-number">3</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Helper</span></span>
  <span class="hljs-attribute">constructor</span>: <span class="hljs-function"><span class="hljs-params">(<span class="hljs-property">@comps</span>)</span>-&gt;</span>
  <span class="hljs-attribute">number</span>: <span class="hljs-function"><span class="hljs-params">(num)</span>-&gt;</span>
    <span class="hljs-property">@comps</span>.build_number(<span class="hljs-attribute">value</span>: num)
  <span class="hljs-attribute">expression</span>: <span class="hljs-function"><span class="hljs-params">(cont)</span>-&gt;</span>
    <span class="hljs-property">@comps</span>.build_expression <span class="hljs-attribute">expression</span>: cont
  <span class="hljs-attribute">numberExpression</span>: <span class="hljs-function"><span class="hljs-params">(num)</span>-&gt;</span>
    <span class="hljs-property">@expression</span>(<span class="hljs-property">@number</span>(num))</pre></div></div>
            
        </li>
        
    </ul>
  </div>
</body>
</html>
